
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>The finite-difference method &#8212; Runge-Kutta Methods and Computational Linear Algebra</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=62ba249389abaaa9ffc34bf36a076bdc1d65ee18" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=f31d14ad54b65d19161ba51d4ffff3a77ae00456"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Chapter summary" href="5.3_BVP_summary.html" />
    <link rel="prev" title="The shooting method" href="5.1_Shooting_method.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
      
      
      <h1 class="site-logo" id="site-title">Runge-Kutta Methods and Computational Linear Algebra</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../index.html">
                    <no title>
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Preamble
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../0_Preamble/0.0_About.html">
   About
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../0_Preamble/0.1_Teaching_schedule.html">
   Teaching schedule
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../0_Preamble/0.3_Python_and_MATLAB.html">
   Python &amp; MATLAB
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../0_Preamble/0.4_Learning_and_teaching.html">
   Learning and teaching
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Runge-Kutta Methods
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../1_IVPs/1.0_IVPs.html">
   Initial Value Problems
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_IVPs/1.1_Taylor_Series.html">
     The Taylor Series
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_IVPs/1.2_Euler_Method.html">
     The Euler method
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_IVPs/1.3_Error_Analysis.html">
     Error analysis
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_IVPs/1.4_RK2.html">
     The Second-Order Runge-Kutta Method
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_IVPs/1.5_Higher_Order_ODEs.html">
     Higher-order Ordinary Differential Equations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_IVPs/1.6_IVP_Summary.html">
     Initial Value Problems Chapter Summary
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_IVPs/1.7_Exercises.html">
     Initial Value Problems Exercises
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../2_ERKs/2.0_ERKs.html">
   Explicit Runge-Kutta Methods
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../2_ERKs/2.1_ERK_Derivation.html">
     Derivation of Explicit Runge-Kutta Methods
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../2_ERKs/2.2_RK4_Derivation.html">
     Derivation of a fourth-order explicit Runge-Kutta method
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../2_ERKs/2.3_Solving_IVPs_using_ERK_methods.html">
     Solving initial value problems using explicit Runge-Kutta methods
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../2_ERKs/2.4_ERK_Summary.html">
     Chapter Summary
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../2_ERKs/2.5_ERK_Exercises.html">
     Explicit Runge-Kutta Methods Exercises
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../3_IRKs/3.0_IRKs.html">
   Implicit Runge-Kutta Methods
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_IRKs/3.1_Deriving_IRK_methods.html">
     Deriving implicit Runge-Kutta methods
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_IRKs/3.2_Solving_IVPs_using_IRK_methods.html">
     Solving initial value problems using implicit Runge-Kutta methods
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_IRKs/3.3_IRK_summary.html">
     Chapter Summary
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_IRKs/3.4_IRK_exercises.html">
     Implicit Runge-Kutta Methods Exercises
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../4_Stability/4.0_Stability.html">
   Stability
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../4_Stability/4.1_Stability_functions.html">
     Stability functions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../4_Stability/4.2_RK_stability_function.html">
     Stability function of a Runge-Kutta method
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../4_Stability/4.3_IRK_stability_function.html">
     Stability functions of implicit methods
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../4_Stability/4.4_Stability_summary.html">
     Chapter summary
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../4_Stability/4.5_Stability_exercises.html">
     Stability Exercises
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="5.0_BVPs.html">
   Boundary Value Problems
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="5.1_Shooting_method.html">
     The shooting method
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     The finite-difference method
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="5.3_BVP_summary.html">
     Chapter summary
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="5.4_BVP_exercises.html">
     Boundary value problems exercises
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Solving Linear Systems of Equations
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../6_Direct_methods/6.0_Direct_methods.html">
   Direct Methods
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../6_Direct_methods/6.1_LU_decomposition.html">
     LU decomposition
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../6_Direct_methods/6.2_LUP_decomposition.html">
     LUP decomposition
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../6_Direct_methods/6.3_Cholesky_decomposition.html">
     Cholesky decomposition
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../6_Direct_methods/6.4_QR_decomposition.html">
     QR decomposition
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../6_Direct_methods/6.5_Direct_methods_summary.html">
     Chapter summary
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../6_Direct_methods/6.6_Direct_methods_exercises.html">
     Direct methods exercises
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../7_Indirect_methods/7.0_Indirect_methods.html">
   Indirect Methods
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
  <label for="toctree-checkbox-7">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../7_Indirect_methods/7.1_Jacobi_method.html">
     Jacobi method
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../7_Indirect_methods/7.2_Gauss_Seidel_method.html">
     Gauss-Seidel method
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../7_Indirect_methods/7.3_Convergence_of_indirect_methods.html">
     Convergence of indirect methods
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../7_Indirect_methods/7.4_SOR_method.html">
     The Successive Over Relaxation (SOR) method
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../7_Indirect_methods/7.5_Indirect_methods_summary.html">
     Chapter summary
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../7_Indirect_methods/7.6_Indirect_methods_exercises.html">
     Indirect methods exercises
    </a>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/drjonshiach/ODEs_book/main?urlpath=tree/5_BVPs/5.2_Finite_difference_method.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../_sources/5_BVPs/5.2_Finite_difference_method.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#the-thomas-algorithm">
   The Thomas algorithm
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#python-code">
   Python code
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#accuracy-vs-number-of-nodes">
   Accuracy vs number of nodes
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>The finite-difference method</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#the-thomas-algorithm">
   The Thomas algorithm
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#python-code">
   Python code
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#accuracy-vs-number-of-nodes">
   Accuracy vs number of nodes
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="the-finite-difference-method">
<span id="finite-difference-method-section"></span><h1>The finite-difference method<a class="headerlink" href="#the-finite-difference-method" title="Permalink to this headline">#</a></h1>
<p>The <strong>finite-difference method</strong> for solving a boundary value problem replaces the derivatives in the ODE with <strong>finite-difference approximations</strong> derived from the Taylor series. This results in linear system of algebraic equations that can be solved to give an approximation of the solution to the BVP.</p>
<p>The derivatives of <span class="math notranslate nohighlight">\(y_i\)</span> are approximated using values of neighbouring nodes <span class="math notranslate nohighlight">\(y_{i+1}\)</span>, <span class="math notranslate nohighlight">\(y_{i-1}\)</span> etc. using expressions derived by truncating the <a class="reference internal" href="../1_IVPs/1.1_Taylor_Series.html#taylor-series-definition"><span class="std std-ref">Taylor series</span></a> and rearranging to make the derivative term the subject. Some common finite-difference approximations are listed in the table below.</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="text-align:left head"><p>Finite-difference approximation</p></th>
<th class="text-align:left head"><p>Order</p></th>
<th class="text-align:left head"><p>Name</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-align:left"><p><span class="math notranslate nohighlight">\(y' = \dfrac{y_{i+1} - y_i}{h}\)</span></p></td>
<td class="text-align:left"><p>first</p></td>
<td class="text-align:left"><p>forward difference</p></td>
</tr>
<tr class="row-odd"><td class="text-align:left"><p><span class="math notranslate nohighlight">\(y' = \dfrac{y_i - y_{i-1}}{h}\)</span></p></td>
<td class="text-align:left"><p>first</p></td>
<td class="text-align:left"><p>backward difference</p></td>
</tr>
<tr class="row-even"><td class="text-align:left"><p><span class="math notranslate nohighlight">\(y' = \dfrac{y_{i+1} - y_{i-1}}{2h}\)</span></p></td>
<td class="text-align:left"><p>second</p></td>
<td class="text-align:left"><p>central difference</p></td>
</tr>
<tr class="row-odd"><td class="text-align:left"><p><span class="math notranslate nohighlight">\(y'' = \dfrac{y_{i-1} - 2 y_i + y_{i+1}}{h^2}\)</span></p></td>
<td class="text-align:left"><p>second</p></td>
<td class="text-align:left"><p>symmetric difference</p></td>
</tr>
</tbody>
</table>
<p>The solution to a boundary value problem using then finite-difference method is determined by approximating the derivatives in the ODE using finite-differences. Consider the following boundary value problem</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
    y'' = f(t,y), \qquad t \in [a, b], \qquad y(a) = \alpha, \qquad y(b) = \beta.
\end{align*}\]</div>
<p>Using the symmetric difference to approximate <span class="math notranslate nohighlight">\(y''\)</span> in the ODE we have</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
    y_{i-1} - 2y_i + y_{i+1} = h^2 f(t_i ,y_i).
\end{align*}\]</div>
<p>Since we know that <span class="math notranslate nohighlight">\(y_0 = \alpha\)</span> and <span class="math notranslate nohighlight">\(y_n = \beta\)</span> then the first and last equations become we have a system of <span class="math notranslate nohighlight">\(n\)</span> equations</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
    y_0 &amp;= \alpha, \\
    y_0 - 2y_1 + y_2 &amp;= h^2 f(t_1, y_1), \\
    y_1 - 2y_1 + y_3 &amp;= h^2 f(t_2, y_2), \\
    &amp; \vdots \\
    y_{n-3} - 2y_{n-2} + y_{n-1} &amp;= h^2 f(t_{n-2}, y_{n-2}), \\
    y_{n-2} - 2y_{n-1} + y_{n} &amp;= h^2 f(t_{n-1}, y_{n-1}), \\
    y_{n} &amp;= \beta,
\end{align*}\]</div>
<p>which can be written as the matrix equation</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
    \begin{pmatrix}
        1 &amp; 0 &amp;  &amp;  \\
        1 &amp; -2 &amp; 1 &amp;  &amp; &amp; \\
        &amp; 1 &amp; -2 &amp; 1 &amp; &amp; \\
        &amp; &amp; \ddots &amp; \ddots &amp; \ddots &amp; \\
        &amp; &amp; &amp; 1 &amp; -2 &amp; 1 \\
        &amp; &amp; &amp; &amp; 1 &amp; -2 &amp; 1 \\
        &amp; &amp; &amp; &amp; &amp; 0 &amp; 1
    \end{pmatrix}
    \begin{pmatrix} y_0 \\ y_1 \\ y_2 \\ \vdots \\ y_{n-2} \\ y_{n-1} \\ y_n \end{pmatrix} =
    \begin{pmatrix} \alpha \\ f(t_1, y_1) \\ f(t_2, y_2) \\ \vdots \\ f(t_{n-2},y_{n-2}) \\ f(t_{n-1}, y_{n-1}) \\ \beta \end{pmatrix}.
\end{align*}\]</div>
<p>Once the linear system is defined it can be solved using LU decomposition.</p>
<div class="section" id="the-thomas-algorithm">
<h2>The Thomas algorithm<a class="headerlink" href="#the-thomas-algorithm" title="Permalink to this headline">#</a></h2>
<p>The coefficient matrix for the linear system that results from the application of the second-order symmetric finite-difference approximation of <span class="math notranslate nohighlight">\(y''\)</span> is <a class="reference external" href="https://en.wikipedia.org/wiki/Tridiagonal_matrix">tridiagonal</a> (the only non-zero elements are on the main, lower and upper diagonals). The usual methods for solving linear systems of equations such as Gaussian elimination and LU decomposition could be applied here, however there is a more efficient method that can solve tridiagonal systems called the <a class="reference external" href="https://en.wikipedia.org/wiki/Tridiagonal_matrix_algorithm"><strong>Thomas algorithm</strong></a>.</p>
<div class="note admonition" id="thomas-method-definition">
<p class="admonition-title">Definition: The Thomas algorithm</p>
<p>Given a tridiagonal linear system of equations of the form</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
    \begin{pmatrix} 
        b_1 &amp; c_1 \\
        a_2 &amp; b_2 &amp; c_2 \\
        &amp; a_3 &amp; b_3 &amp; \ddots \\
        &amp; &amp; \ddots &amp; \ddots &amp; c_{n-1} \\
        &amp; &amp; &amp; a_n &amp; b_n
    \end{pmatrix}
    \begin{pmatrix} x_1 \\ x_2 \\ x_3 \\ \vdots \\ x_n \end{pmatrix} =
    \begin{pmatrix} d_1 \\ d_2 \\ d_3 \\ \vdots \\ d_n \end{pmatrix},
\end{align*}\]</div>
<p>the solution can be found by performing a forward sweep on the <span class="math notranslate nohighlight">\(b_i\)</span> and <span class="math notranslate nohighlight">\(d_i\)</span> coefficients</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
    b_i &amp;= b_i - c_{i-1} \left( \frac{a_i}{b_{i-1}} \right), &amp; i = 2, 3, \ldots, n, \\
    d_i &amp;= d_i - d_{i-1} \left( \frac{a_i}{b_{i-1}} \right), &amp; i = 2, 3, \ldots, n, 
\end{align*}\]</div>
<p>the solution is then found using back substitution</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
    x_n &amp;= \frac{d_n}{b_n}, \\
    x_i &amp;= \frac{d_i - c_i x_{i+1}}{b_i}, \qquad i = n-1, n-2, \ldots, 1.
\end{align*}\]</div>
</div>
<div class="seealso admonition" id="bvp-finite-difference-example">
<p class="admonition-title">Example 5.4</p>
<p>Use the finite-difference method to solve the boundary below using a step length of <span class="math notranslate nohighlight">\(h = 0.2\)</span></p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
    y'' - y' - y = 0, \qquad y(0) = 0, \qquad y(1) = 2.
\end{align*}\]</div>
<p><strong>Solution</strong></p>
<p>Using a forward difference to approximate <span class="math notranslate nohighlight">\(y'\)</span> and a symmetric difference to approximate <span class="math notranslate nohighlight">\(y''\)</span> we have</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
    \frac{y_{i-1} -2y_i +y_{i+1} }{h^2 }-\frac{y_{i+1} -y_i }{h}-y_i = 0,
\end{align*}\]</div>
<p>which can be simplified to</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
    y_{i-1} +(h-h^2 -2)y_i +(1-h)y_{i+1} = 0.
\end{align*}\]</div>
<p>This gives the following system of linear equations</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
    y_0 &amp;= 0, \\
    y_0 + (h - h^2 - 2) y_1 + (1 - h) y_2 &amp;= 0, \\
    y_1 + (h - h^2 - 2) y_2 + (1 - h) y_3 &amp;= 0, \\
    &amp;\vdots \\
    y_{n-2} + (h - h^2 - 2) y_{n-1} + (1 - h) y_n &amp;= 0, \\
    y_n &amp;= 2.
\end{align*}\]</div>
<p>which we can write the linear system as the matrix equation</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
    \begin{pmatrix}
        1 &amp; 0 &amp; &amp;  &amp;  &amp; \\
        1 &amp; h-h^2 -2 &amp; 1-h &amp;  &amp;  &amp; \\
        &amp;  \ddots  &amp; \ddots  &amp; \ddots  &amp; \\
        &amp;  &amp; 1 &amp; h-h^2 -2 &amp; 1-h \\
        &amp;  &amp;  &amp; 0 &amp; 1
    \end{pmatrix} 
    \begin{pmatrix} y_0 \\ y_1 \\ \vdots \\ y_{n-1} \\ y_n \end{pmatrix}  =
    \begin{pmatrix} 0 \\ 0 \\ \vdots \\ 0 \\ 2  \end{pmatrix}.
\end{align*}\]</div>
<p>If we use a step length of <span class="math notranslate nohighlight">\(h=0.2\)</span> we have</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
    \mathbf{t} = (0, 0.2, 0.4, 0.6, 0.8, 1),
\end{align*}\]</div>
<p>and</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
    \begin{pmatrix}
        1 &amp; 0 \\
        1 &amp; -1.84 &amp; 0.8 \\
        &amp; 1 &amp; -1.84 &amp; 0.8 \\
        &amp; &amp; 1 &amp; -1.84 &amp; 0.8 \\
        &amp; &amp; &amp; 1 &amp; -1.84 &amp; 0.8 \\
        &amp; &amp; &amp; &amp; 0 &amp; 1
    \end{pmatrix}
    \begin{pmatrix} y_0 \\ y_1 \\ y_2 \\ y_3 \\ y_4 \\ y_5 \end{pmatrix} = 
    \begin{pmatrix} 0 \\ 0 \\ 0 \\ 0 \\ 0 \\ 2 \end{pmatrix}.
\end{align*}\]</div>
<p>Performing the forward sweep of the Thomas algorithm</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
    b_1 &amp;= 1, \\ 
    b_2 &amp;= b_2 - c_1 \left( \frac{a_2}{b_1} \right) = -1.84 - 0.8 \left( \frac{1}{1} \right) = -2.64, \\
    b_3 &amp;= b_3 - c_2 \left( \frac{a_3}{b_2} \right) = -1.84 - 0.8 \left( \frac{1}{-2.64} \right) = -1.405217, \\
    b_4 &amp;= b_4 - c_3 \left( \frac{a_4}{b_3} \right) = -1.84 - 0.8 \left( \frac{1}{-1.405217} \right) = -1.270693, \\
    b_5 &amp;= b_5 - c_4 \left( \frac{a_5}{b_4} \right) = -1.84 - 0.8 \left( \frac{1}{-1.270693} \right) = -1.210422, \\
    b_6 &amp;= b_6 - c_5 \left( \frac{a_6}{b_5} \right) = 1 - 0.8 \left( \frac{0}{-1.210422} \right) = 1, \\
    d_1 &amp;= 0, \\
    d_2 &amp;= d_2 - d_1 \left( \frac{a_2}{b_1} \right) = 0 - 0 \left( \frac{1}{1} \right) = 0, \\
    d_3 &amp;= d_3 - d_2 \left( \frac{a_3}{b_2} \right) = 0 - 0 \left( \frac{1}{-2.64} \right) = 0, \\
    d_4 &amp;= d_4 - d_3 \left( \frac{a_4}{b_3} \right) = 0 - 0 \left( \frac{1}{-1.405217} \right) = 0, \\
    d_5 &amp;= d_5 - d_4 \left( \frac{a_5}{b_4} \right) = 0 - 0 \left( \frac{1}{-1.270693} \right) = 0, \\
    d_6 &amp;= d_6 - d_5 \left( \frac{a_6}{b_5} \right) = 2 - 0 \left( \frac{0}{-1.270693} \right) = 2, \\
\end{align*}\]</div>
<p>Performing the back substitution</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
    y_6 &amp;= \frac{d_6}{b_6} = \frac{2}{1} = 2, \\
    y_5 &amp;= \frac{d_5 - c_5 y_6}{b_5} = \frac{0 - 0.8(2)}{-1.210422} = 1.321853, \\
    y_4 &amp;= \frac{d_4 - c_4 y_5}{b_4} = \frac{0 - 0.8(1.321853)}{-1.270693} = 0.832209, \\
    y_3 &amp;= \frac{d_3 - c_3 y_4}{b_3} = \frac{0 - 0.8(0.832209)}{-1.405217} = 0.473782, \\
    y_2 &amp;= \frac{d_2 - c_2 y_3}{b_2} = \frac{0 - 0.8(0.473782)}{-2.64} = 0.205992, \\
    y_1 &amp;= \frac{d_1 - c_1 y_2}{b_1} = \frac{0 - 0(0.205992)}{1} = 0, \\
\end{align*}\]</div>
<p>The solutions to this boundary value problem using the finite-difference method are tabulated below.</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="text-align:center head"><p><span class="math notranslate nohighlight">\(t\)</span></p></th>
<th class="text-align:center head"><p><span class="math notranslate nohighlight">\(y\)</span></p></th>
<th class="text-align:center head"><p>Exact</p></th>
<th class="text-align:center head"><p>Error</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-align:center"><p>0.00</p></td>
<td class="text-align:center"><p>0.0000</p></td>
<td class="text-align:center"><p>0.0000</p></td>
<td class="text-align:center"><p>0.00e+00</p></td>
</tr>
<tr class="row-odd"><td class="text-align:center"><p>0.20</p></td>
<td class="text-align:center"><p>0.2060</p></td>
<td class="text-align:center"><p>0.2213</p></td>
<td class="text-align:center"><p>1.53e-02</p></td>
</tr>
<tr class="row-even"><td class="text-align:center"><p>0.40</p></td>
<td class="text-align:center"><p>0.4738</p></td>
<td class="text-align:center"><p>0.5014</p></td>
<td class="text-align:center"><p>2.76e-02</p></td>
</tr>
<tr class="row-odd"><td class="text-align:center"><p>0.60</p></td>
<td class="text-align:center"><p>0.8322</p></td>
<td class="text-align:center"><p>0.8658</p></td>
<td class="text-align:center"><p>3.36e-02</p></td>
</tr>
<tr class="row-even"><td class="text-align:center"><p>0.80</p></td>
<td class="text-align:center"><p>1.3219</p></td>
<td class="text-align:center"><p>1.3494</p></td>
<td class="text-align:center"><p>2.76e-02</p></td>
</tr>
<tr class="row-odd"><td class="text-align:center"><p>1.00</p></td>
<td class="text-align:center"><p>2.0000</p></td>
<td class="text-align:center"><p>2.0000</p></td>
<td class="text-align:center"><p>0.00e+00</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="python-code">
<h2>Python code<a class="headerlink" href="#python-code" title="Permalink to this headline">#</a></h2>
<p>The code below calculates the solution to the boundary value problem in  <a class="reference internal" href="#bvp-finite-difference-example"><span class="std std-ref">example 5.4</span></a>. The coefficient arrays <code class="docutils literal notranslate"><span class="pre">a</span></code>, <code class="docutils literal notranslate"><span class="pre">b</span></code> and <code class="docutils literal notranslate"><span class="pre">c</span></code> along with the constant vector <code class="docutils literal notranslate"><span class="pre">d</span></code> are defined for this problem and the <code class="docutils literal notranslate"><span class="pre">tridiagonal_solver()</span></code> function is used to solve the linear system. Note that the values in <code class="docutils literal notranslate"><span class="pre">a</span></code>, <code class="docutils literal notranslate"><span class="pre">b</span></code>, <code class="docutils literal notranslate"><span class="pre">c</span></code> and <code class="docutils literal notranslate"><span class="pre">d</span></code> are specific to the problem being solved and will need to be changed when solving other boundary value problems.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="k">def</span> <span class="nf">tridiagonal_solver</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">):</span>
    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
        <span class="n">w</span> <span class="o">=</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">/</span> <span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-=</span> <span class="n">w</span> <span class="o">*</span> <span class="n">c</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">d</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-=</span> <span class="n">w</span> <span class="o">*</span> <span class="n">d</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
    <span class="n">x</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">d</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="n">b</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">c</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span> <span class="o">/</span> <span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    
    <span class="k">return</span> <span class="n">x</span>
    
    
<span class="k">def</span> <span class="nf">exact</span><span class="p">(</span><span class="n">t</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">((</span><span class="mi">1</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span> <span class="o">*</span> <span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span> <span class="o">-</span><span class="mi">1</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
 

<span class="c1"># Define BVP parameters</span>
<span class="n">tspan</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>  <span class="c1"># boundaries of the t domain</span>
<span class="n">bvals</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>  <span class="c1"># boundary values</span>
<span class="n">h</span> <span class="o">=</span> <span class="mf">0.2</span>         <span class="c1"># step length</span>

<span class="c1"># Define linear system</span>
<span class="n">n</span> <span class="o">=</span> <span class="nb">int</span><span class="p">((</span><span class="n">tspan</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">tspan</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">/</span> <span class="n">h</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">*</span> <span class="n">h</span>
<span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">)]</span>
<span class="n">b</span><span class="p">[::</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">d</span><span class="p">[::</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">bvals</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
    <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">h</span> <span class="o">-</span> <span class="n">h</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">-</span> <span class="mi">2</span>
    <span class="n">c</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">h</span>
    <span class="n">d</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
        
<span class="c1"># Solve linear system</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">tridiagonal_solver</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span>

<span class="c1"># Print table of solution values</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;|  t   |   y    | Exact  |  Error   |&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;|:----:|:------:|:------:|:--------:|&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">)):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;| </span><span class="si">{</span><span class="n">t</span><span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="si">:</span><span class="s2">4.2f</span><span class="si">}</span><span class="s2"> | </span><span class="si">{</span><span class="n">y</span><span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="si">:</span><span class="s2">6.4f</span><span class="si">}</span><span class="s2"> | </span><span class="si">{</span><span class="n">exact</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="n">n</span><span class="p">])</span><span class="si">:</span><span class="s2">6.4f</span><span class="si">}</span><span class="s2"> | </span><span class="si">{</span><span class="nb">abs</span><span class="p">(</span><span class="n">exact</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="n">n</span><span class="p">])</span> <span class="o">-</span> <span class="n">y</span><span class="p">[</span><span class="n">n</span><span class="p">])</span><span class="si">:</span><span class="s2">6.2e</span><span class="si">}</span><span class="s2"> |&quot;</span><span class="p">)</span>
    
<span class="c1"># Plot solution</span>
<span class="n">t_exact</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">tspan</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">200</span><span class="p">)</span>
<span class="n">y_exact</span> <span class="o">=</span> <span class="n">exact</span><span class="p">(</span><span class="n">t_exact</span><span class="p">)</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t_exact</span><span class="p">,</span> <span class="n">y_exact</span><span class="p">,</span> <span class="s2">&quot;k-&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Exact&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s2">&quot;bo-&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Finite-difference method&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;$t$&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;$y$&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>|  t   |   y    | Exact  |  Error   |
|:----:|:------:|:------:|:--------:|
| 0.00 | 0.0000 | 0.0000 | 0.00e+00 |
| 0.20 | 0.2060 | 0.2213 | 1.53e-02 |
| 0.40 | 0.4738 | 0.5014 | 2.76e-02 |
| 0.60 | 0.8322 | 0.8658 | 3.36e-02 |
| 0.80 | 1.3219 | 1.3494 | 2.76e-02 |
| 1.00 | 2.0000 | 2.0000 | 0.00e+00 |
</pre></div>
</div>
<img alt="../_images/5.2_Finite_difference_method_1_1.png" src="../_images/5.2_Finite_difference_method_1_1.png" />
</div>
</div>
</div>
<div class="section" id="accuracy-vs-number-of-nodes">
<h2>Accuracy vs number of nodes<a class="headerlink" href="#accuracy-vs-number-of-nodes" title="Permalink to this headline">#</a></h2>
<p>The solutions seen in <a class="reference internal" href="#bvp-finite-difference-example"><span class="std std-ref">example 5.4</span></a> seem to show that the finite-difference method produces reasonably accurate results for this boundary value problem. One way to improve on the accuracy of our solution is to increase the number of nodes used.</p>
<p>Consider the solution of the following BVP using the finite-difference method</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
    y'' + 3ty' + 7y = \cos (2t), \qquad y(0) = 1, \qquad y(3) = 0.
\end{align*}\]</div>
<p>Using forward and symmetric differences to approximate <span class="math notranslate nohighlight">\(y'\)</span> and <span class="math notranslate nohighlight">\(y''\)</span> respectively gives</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
    \frac{y_{i-1} - 2y_i + y_{i+1}}{h^2} + 3t_i \left( \frac{y_{i+1} - y_i}{h}\right) + 7y_i &amp;= \cos(2t_i) \\
    y_{i-1} + (7h^2 - 3ht_i - 2)y_i + (1 + 3ht_i)y_{i+1} &amp;= h^2 \cos(2t_i).
\end{align*}\]</div>
<p>So the linear system is</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
    \begin{pmatrix} 
        1 &amp; 0 \\
        1 &amp; 7h^2 - 3ht_1 - 2 &amp; 1 + 3ht_1 \\
        &amp; \ddots &amp; \ddots &amp; \ddots \\
        &amp;&amp; 1 &amp; 7h^2 - 3ht_{N-1} - 2 &amp; 1 + 3ht_{N-1} \\
        &amp;&amp;&amp; 0 &amp; 1
    \end{pmatrix}
    \begin{pmatrix} y_0 \\ y_1 \\ \vdots \\ y_{N-1} \\ y_N \end{pmatrix} \\
    = \begin{pmatrix} 1 \\ h^2 \cos(2t_1) \\ \vdots \\ h^2 \cos(2t_{N-1}) \\ 0 \end{pmatrix}.
\end{align*}\]</div>
<p>The solution of this BVP is shown in <a class="reference internal" href="#bvp-fdm-accuracy-figure-1"><span class="std std-numref">Fig. 17</span></a> for <span class="math notranslate nohighlight">\(h=0.05\)</span> and <span class="math notranslate nohighlight">\(h = 0.005\)</span>. Since we used a first-order approximation for <span class="math notranslate nohighlight">\(y'\)</span> the error for this method is <span class="math notranslate nohighlight">\(O(h)\)</span> and we expect the solution using <span class="math notranslate nohighlight">\(h=0.005\)</span> to be more accurate.</p>
<div class="figure align-default" id="bvp-fdm-accuracy-figure-1">
<div class="cell_output docutils container">
<img alt="../_images/5.2_Finite_difference_method_4_1.png" src="../_images/5.2_Finite_difference_method_4_1.png" />
</div>
<p class="caption"><span class="caption-number">Fig. 17 </span><span class="caption-text">Solutions to the boundary value problem <span class="math notranslate nohighlight">\(y'' + 3ty' + 7y = \cos (2t)\)</span>, <span class="math notranslate nohighlight">\(t \in [0,3]\)</span>, <span class="math notranslate nohighlight">\(y(0) = 1\)</span>, <span class="math notranslate nohighlight">\(y(3) = 0\)</span> using first-order finite-difference approximations with <span class="math notranslate nohighlight">\(h=0.05\)</span> and <span class="math notranslate nohighlight">\(h=0.005\)</span>.</span><a class="headerlink" href="#bvp-fdm-accuracy-figure-1" title="Permalink to this image">#</a></p>
</div>
<p>To obtain a more accurate solution, instead of increasing the number of nodes we could use the <a class="reference internal" href="#finite-difference-method-section"><span class="std std-ref">central difference approximation</span></a> (which is second-order accurate) to approximate <span class="math notranslate nohighlight">\(y'\)</span></p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
    \frac{y_{i-1} - 2y_i + y_{i+1}}{h^2} + 3t_i\left( \frac{y_{i+1} - y_{i-1}}{2h} \right) + 7y_i &amp;= \cos(2t_i) \\
    (2 - 3ht_i)y_{i-1} + (14h^2 - 4)y_i + (2 + 3ht_i)y_{i+1} &amp;= 2h^2 \cos(2t_i).
\end{align*}\]</div>
<p>So the linear system for the second-order finite-difference method is</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
    \begin{pmatrix} 
        1 &amp; 0 \\
        2 - 3ht_1 &amp; 14h^2 - 4 &amp; 2 + 3ht_1 \\
        &amp; \ddots &amp; \ddots &amp; \ddots \\
        &amp;&amp; 2 - 3ht_{N-1} &amp; 14h^2 - 4 &amp; 2 + 3ht_{N-1} \\
        &amp;&amp;&amp; 0 &amp; 1
    \end{pmatrix}
    \begin{pmatrix} y_0 \\ y_1 \\ \vdots \\ y_{N-1} \\ y_N \end{pmatrix} \\
    = \begin{pmatrix} 1 \\ 2h^2 \cos(2t_1) \\ \vdots \\ 2h^2 \cos(2t_{N-1}) \\ 0 \end{pmatrix}.
\end{align*}\]</div>
<p>The solution using the second-order finite difference method with <span class="math notranslate nohighlight">\(h=0.05\)</span> has been plotted against the first-order solution using <span class="math notranslate nohighlight">\(h=0.05\)</span> and <span class="math notranslate nohighlight">\(h=0.005\)</span> in <a class="reference internal" href="#bvp-fdm-accuracy-figure-2"><span class="std std-numref">Fig. 18</span></a>. The second order solution gives good agreement with the first order solution using 10 times fewer nodes.</p>
<div class="figure align-default" id="bvp-fdm-accuracy-figure-2">
<div class="cell_output docutils container">
<img alt="../_images/5.2_Finite_difference_method_4_3.png" src="../_images/5.2_Finite_difference_method_4_3.png" />
</div>
<p class="caption"><span class="caption-number">Fig. 18 </span><span class="caption-text">Solutions to the boundary value problem <span class="math notranslate nohighlight">\(y'' + 3ty' + 7y = \cos (2t)\)</span>, <span class="math notranslate nohighlight">\(t \in [0,3]\)</span>, <span class="math notranslate nohighlight">\(y(0) = 1\)</span>, <span class="math notranslate nohighlight">\(y(3) = 0\)</span> using first-order and second-order finite-difference approximations with <span class="math notranslate nohighlight">\(h=0.05\)</span> and <span class="math notranslate nohighlight">\(h=0.005\)</span>.</span><a class="headerlink" href="#bvp-fdm-accuracy-figure-2" title="Permalink to this image">#</a></p>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./5_BVPs"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="5.1_Shooting_method.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">The shooting method</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="5.3_BVP_summary.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Chapter summary</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Dr Jon Shiach<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>